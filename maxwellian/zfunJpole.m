% 24-04-13 14:00, Hua-sheng XIE, huashengxie@gmail.com
% Plasma dispersion function Z(zeta), use J-pole, Xie2019, CPC, BO
% Compare with accurate zfun(), agree well.
% This J-pole version can be readily rewritten to fortran/C/python
function Zeta=zfunJpole(z,J)
if nargin < 2
    J=8;
end

if(J==8) % J-pole, usually J=8 is sufficient
    % 18-12-28 11:11
    bzj(1)=   -0.017340112270401 - 0.046306439626294i;
    bzj(2)=   -0.739917811220052 + 0.839518284620274i;
    bzj(3)=   5.840632105105495 + 0.953602751322040i;
    bzj(4)=   -5.583374181615043 -11.208550459628098i;
    czj(1)=   2.237687725134293 - 1.625941024120362i;
    czj(2)=   1.465234091939142 - 1.789620299603315i;
    czj(3)=   0.839253966367922 - 1.891995211531426i;
    czj(4)=   0.273936218055381 - 1.941787037576095i;

    bzj(5:8)=conj(bzj(1:4));
    czj(5:8)=-conj(czj(1:4));
elseif(J==12) % from Cal_J_pole_bjcj.m
    % J=12; I=12; 18-12-28 22:35
    bzj(1)=  - 10.020983259474214017 - 14.728932929429874883i;
    bzj(2)= - 0.58878169153449514493 + 0.19067303610080007359i;
    bzj(3)= - 0.27475707659732384029 + 3.617920717493884482i;
    bzj(4)= 0.00045713742777499515344 + 0.00027155393843737098852i;
    bzj(5)=  0.017940627032508378515 - 0.036436053276701248142i;
    bzj(6)=  10.366124263145749629 - 2.5069048649816145967i;
    czj(1)= 0.22660012611958088507627 - 2.0716877594897791206264i;
    czj(2)= - 1.70029215163003500750575 - 1.8822474221612724460388i;
    czj(3)= 1.17139325085601178534269 - 1.97725033192085410977458i;
    czj(4)= 3.0666201126826972102007 - 1.59002082593259971758095i;
    czj(5)= 2.307327490410578276422 - 1.7546732543728200653674i;
    czj(6)= 0.687200524906019065672977 - 2.040288525975844018682i;

    bzj(7:12)=conj(bzj(1:6));
    czj(7:12)=-conj(czj(1:6));
elseif(J==16)
    opt=1;
    if(opt==1) % J=16; I=18;
        bzj(1)= - 86.416592794839804566 - 147.57960545984972964i;
        bzj(2)= - 22.962540986214500398 + 46.211318219085729914i;
        bzj(3)= - 8.8757833558787660662 - 11.561957978688249474i;
        bzj(4)= - 0.025134802434111256483 + 0.19730442150379382482i;
        bzj(5)= - 0.0056462830661756538039 - 0.0027884991898011769583i;
        bzj(6)= 0.000028262945845046458372 + 0.000026335348714810255537i;
        bzj(7)= 2.3290098166119338312 - 0.57238325918028725167i;
        bzj(8)= 115.45666014287557906 - 2.8617578808752183449i;
        czj(1)= 0.1966439744113664608458045976392 - 2.5854046363167904820930238267552i;
        czj(2)= 1.000427687089304511157923736374 - 2.5277610669350594581215470753126i;
        czj(3)= 1.4263380087098663428834704281261 - 2.4694803409658086505344546718783i;
        czj(4)= 2.382753075769737513956410751299 - 2.2903917960623787648467068236658i;
        czj(5)= 2.9566517643704010426779572638885 - 2.1658992556376956216621262314559i;
        czj(6)= - 3.6699741330155866185481740497527 - 2.008727613312046260114172119472i;
        czj(7)= 1.8818356204685089975461092960437 - 2.3907395820644127767937911780402i;
        czj(8)= 0.5933003629474285223202174828712 - 2.5662607006180515205167080595386i;
    end
    bzj(9:16)=conj(bzj(1:8));
    czj(9:16)=-conj(czj(1:8));
elseif(J==24)
    % J=24,I=24
    bzj(1)= - 579.77656932346560644 - 844.01436313629880827i;
    bzj(2)= - 179.52530851977905732 - 86.660002027244731382i;
    bzj(3)= - 52.107235029274485215 + 453.3246806707749413i;
    bzj(4)= - 2.1607927691932962178 + 0.63681255371973499384i;
    bzj(5)= - 0.018283386874895507814 - 0.21941582055233427677i;
    bzj(6)= - 0.00006819511737162705016 + 0.00032026091897256872621i;
    bzj(7)= - 0.0000028986123310445793648 - 0.00000099510625011385493369i;
    bzj(8)= 0.0000000023382228949223867744 - 0.0000000040404517369565098657i;
    bzj(9)= 0.01221466589423530596 + 0.00097890737323377354166i;
    bzj(10)= 7.3718296773233126912 - 12.575687057120635407i;
    bzj(11)= 44.078424019374375065 - 46.322124026599601416i;
    bzj(12)= 761.62579175738689742 + 185.11797721443392707i;
    czj(1)= 0.16167711630587375808393823760988 - 2.9424665391729649010502939606152i;
    czj(2)= 1.1509135876493567244599398043479 - 2.8745542965490153159866506667543i;
    czj(3)= 0.81513635269214329286824152984179 - 2.9085569383176322446978082849749i;
    czj(4)= 2.2362950589041724110736073820844 - 2.7033607074680388479084431872604i;
    czj(5)= 2.6403561313404041541230494846625 - 2.6228400297078984516779261304916i;
    czj(6)= 3.5620497451197056657834990483967 - 2.4245607245823420555878190731282i;
    czj(7)= 4.116925125710675393072860873751 - 2.3036541720854573608940600179944i;
    czj(8)= 4.8034117493360317933109830717707 - 2.1592490859689535412501218722927i;
    czj(9)= 3.0778922349246567316482750461458 - 2.5301774598854448463007864644617i;
    czj(10)= - 1.8572088635240765003561090479193 - 2.7720571884094886583775397071469i;
    czj(11)= 1.4969881322466893380396663902149 - 2.8290855580900544693059801078858i;
    czj(12)= - 0.48636891219330428093331493852099 - 2.9311741817223824196339069754696i;

    bzj(13:24)=conj(bzj(1:12));
    czj(13:24)=-conj(czj(1:12));
end

for j=1:length(z)
    if(imag(z(j))>=0)
        Zeta=sum(bzj./(z(j)-czj));
    else
        Zeta=conj(sum(bzj./(conj(z(j))-czj)))+2i*sqrt(pi)*exp(-(z(j))^2);
    end
end

end